nohup: ignoring input
W0620 17:49:42.279000 3317907 site-packages/torch/distributed/run.py:766] 
W0620 17:49:42.279000 3317907 site-packages/torch/distributed/run.py:766] *****************************************
W0620 17:49:42.279000 3317907 site-packages/torch/distributed/run.py:766] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0620 17:49:42.279000 3317907 site-packages/torch/distributed/run.py:766] *****************************************
2025-06-20 17:49:46.889 | INFO     | utils.common:log:12 - Process group initialize
2025-06-20 17:49:46.889 | INFO     | utils.common:log:12 - ****************************************
2025-06-20 17:49:46.889 | INFO     | utils.common:log:12 - Start training with arguments
2025-06-20 17:49:46.890 | INFO     | utils.common:log:12 - lr                             0.001
2025-06-20 17:49:46.890 | INFO     | utils.common:log:12 - batch_size                     16
2025-06-20 17:49:46.890 | INFO     | utils.common:log:12 - total_batch_size               16
2025-06-20 17:49:46.890 | INFO     | utils.common:log:12 - max_length                     1024
2025-06-20 17:49:46.890 | INFO     | utils.common:log:12 - num_training_steps             10
2025-06-20 17:49:46.890 | INFO     | utils.common:log:12 - grad_clip                      0.0
2025-06-20 17:49:46.890 | INFO     | utils.common:log:12 - warmup                         1000
2025-06-20 17:49:46.890 | INFO     | utils.common:log:12 - constant_lr                    True
2025-06-20 17:49:46.890 | INFO     | utils.common:log:12 - seed                           42
2025-06-20 17:49:46.890 | INFO     | utils.common:log:12 - mixed_precision                bf16
2025-06-20 17:49:46.890 | INFO     | utils.common:log:12 - comp_dim                       64
2025-06-20 17:49:46.890 | INFO     | utils.common:log:12 - tau                            5
2025-06-20 17:49:46.890 | INFO     | utils.common:log:12 - gene_method                    cd
2025-06-20 17:49:46.890 | INFO     | utils.common:log:12 - jump_certain_modules           False
2025-06-20 17:49:46.890 | INFO     | utils.common:log:12 - update_cp_freq                 2
2025-06-20 17:49:46.890 | INFO     | utils.common:log:12 - adaptive_cp_rate               0.0
2025-06-20 17:49:46.890 | INFO     | utils.common:log:12 - model_config                   configs/llama_350m.json
2025-06-20 17:49:46.890 | INFO     | utils.common:log:12 - optimizer                      subscafsgd
2025-06-20 17:49:46.890 | INFO     | utils.common:log:12 - momentum                       0.0
2025-06-20 17:49:46.890 | INFO     | utils.common:log:12 - dampening                      0
2025-06-20 17:49:46.890 | INFO     | utils.common:log:12 - weight_decay                   0
2025-06-20 17:49:46.890 | INFO     | utils.common:log:12 - nesterov                       False
2025-06-20 17:49:46.890 | INFO     | utils.common:log:12 - per_layer_weight_update        False
2025-06-20 17:49:46.890 | INFO     | utils.common:log:12 - use_wandb                      False
2025-06-20 17:49:46.890 | INFO     | utils.common:log:12 - wandb_run_name                 real_lazy_update
2025-06-20 17:49:46.890 | INFO     | utils.common:log:12 - use_tqdm                       False
2025-06-20 17:49:46.890 | INFO     | utils.common:log:12 - use_log                        True
2025-06-20 17:49:46.890 | INFO     | utils.common:log:12 - mem_monitor                    False
2025-06-20 17:49:46.890 | INFO     | utils.common:log:12 - flash_attn                     False
2025-06-20 17:49:46.891 | INFO     | utils.common:log:12 - ****************************************
/home/xuyuqi/.conda/envs/minimind/lib/python3.10/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `pad_token_id` should be positive but got -1. This will cause errors when batch generating, if there is padding. Please set `pad_token_id` explicitly as `model.generation_config.pad_token_id=PAD_TOKEN_ID` to avoid errors in generation
  warnings.warn(
/home/xuyuqi/.conda/envs/minimind/lib/python3.10/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `pad_token_id` should be positive but got -1. This will cause errors when batch generating, if there is padding. Please set `pad_token_id` explicitly as `model.generation_config.pad_token_id=PAD_TOKEN_ID` to avoid errors in generation
  warnings.warn(
2025-06-20 17:49:55.963 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: q_proj
2025-06-20 17:49:56.065 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: k_proj
2025-06-20 17:49:56.066 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: v_proj
2025-06-20 17:49:56.066 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: o_proj
2025-06-20 17:49:56.066 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: gate_proj
2025-06-20 17:49:56.067 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: up_proj
2025-06-20 17:49:56.067 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: down_proj
2025-06-20 17:49:56.084 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: q_proj
2025-06-20 17:49:56.084 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: k_proj
2025-06-20 17:49:56.085 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: v_proj
2025-06-20 17:49:56.085 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: o_proj
2025-06-20 17:49:56.085 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: gate_proj
2025-06-20 17:49:56.086 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: up_proj
2025-06-20 17:49:56.087 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: down_proj
2025-06-20 17:49:56.087 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: q_proj
2025-06-20 17:49:56.087 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: k_proj
2025-06-20 17:49:56.087 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: v_proj
2025-06-20 17:49:56.088 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: o_proj
2025-06-20 17:49:56.088 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: gate_proj
2025-06-20 17:49:56.088 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: up_proj
2025-06-20 17:49:56.089 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: down_proj
2025-06-20 17:49:56.089 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: q_proj
2025-06-20 17:49:56.090 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: k_proj
2025-06-20 17:49:56.090 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: v_proj
2025-06-20 17:49:56.090 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: o_proj
2025-06-20 17:49:56.091 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: gate_proj
2025-06-20 17:49:56.091 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: up_proj
2025-06-20 17:49:56.092 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: down_proj
2025-06-20 17:49:56.092 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: q_proj
2025-06-20 17:49:56.092 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: k_proj
2025-06-20 17:49:56.093 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: v_proj
2025-06-20 17:49:56.093 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: o_proj
2025-06-20 17:49:56.093 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: gate_proj
2025-06-20 17:49:56.094 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: up_proj
2025-06-20 17:49:56.094 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: down_proj
2025-06-20 17:49:56.095 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: q_proj
2025-06-20 17:49:56.095 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: k_proj
2025-06-20 17:49:56.095 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: v_proj
2025-06-20 17:49:56.096 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: o_proj
2025-06-20 17:49:56.096 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: gate_proj
2025-06-20 17:49:56.096 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: up_proj
2025-06-20 17:49:56.097 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: down_proj
2025-06-20 17:49:56.097 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: q_proj
2025-06-20 17:49:56.098 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: k_proj
2025-06-20 17:49:56.098 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: v_proj
2025-06-20 17:49:56.098 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: o_proj
2025-06-20 17:49:56.099 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: gate_proj
2025-06-20 17:49:56.099 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: up_proj
2025-06-20 17:49:56.100 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: down_proj
2025-06-20 17:49:56.100 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: q_proj
2025-06-20 17:49:56.100 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: k_proj
2025-06-20 17:49:56.101 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: v_proj
2025-06-20 17:49:56.101 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: o_proj
2025-06-20 17:49:56.101 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: gate_proj
2025-06-20 17:49:56.102 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: up_proj
2025-06-20 17:49:56.102 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: down_proj
2025-06-20 17:49:56.103 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: q_proj
2025-06-20 17:49:56.103 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: k_proj
2025-06-20 17:49:56.103 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: v_proj
2025-06-20 17:49:56.104 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: o_proj
2025-06-20 17:49:56.104 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: gate_proj
2025-06-20 17:49:56.105 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: up_proj
2025-06-20 17:49:56.105 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: down_proj
2025-06-20 17:49:56.105 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: q_proj
2025-06-20 17:49:56.106 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: k_proj
2025-06-20 17:49:56.106 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: v_proj
2025-06-20 17:49:56.107 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: o_proj
2025-06-20 17:49:56.107 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: gate_proj
2025-06-20 17:49:56.107 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: up_proj
2025-06-20 17:49:56.108 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: down_proj
2025-06-20 17:49:56.108 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: q_proj
2025-06-20 17:49:56.108 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: k_proj
2025-06-20 17:49:56.109 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: v_proj
2025-06-20 17:49:56.109 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: o_proj
2025-06-20 17:49:56.109 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: gate_proj
2025-06-20 17:49:56.110 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: up_proj
2025-06-20 17:49:56.110 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: down_proj
2025-06-20 17:49:56.111 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: q_proj
2025-06-20 17:49:56.111 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: k_proj
2025-06-20 17:49:56.111 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: v_proj
2025-06-20 17:49:56.112 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: o_proj
2025-06-20 17:49:56.112 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: gate_proj
2025-06-20 17:49:56.112 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: up_proj
2025-06-20 17:49:56.113 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: down_proj
2025-06-20 17:49:56.113 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: q_proj
2025-06-20 17:49:56.114 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: k_proj
2025-06-20 17:49:56.114 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: v_proj
2025-06-20 17:49:56.114 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: o_proj
2025-06-20 17:49:56.115 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: gate_proj
2025-06-20 17:49:56.115 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: up_proj
2025-06-20 17:49:56.116 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: down_proj
2025-06-20 17:49:56.116 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: q_proj
2025-06-20 17:49:56.116 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: k_proj
2025-06-20 17:49:56.117 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: v_proj
2025-06-20 17:49:56.117 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: o_proj
2025-06-20 17:49:56.117 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: gate_proj
2025-06-20 17:49:56.118 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: up_proj
2025-06-20 17:49:56.118 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: down_proj
2025-06-20 17:49:56.119 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: q_proj
2025-06-20 17:49:56.119 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: k_proj
2025-06-20 17:49:56.119 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: v_proj
2025-06-20 17:49:56.120 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: o_proj
2025-06-20 17:49:56.120 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: gate_proj
2025-06-20 17:49:56.120 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: up_proj
2025-06-20 17:49:56.121 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: down_proj
2025-06-20 17:49:56.121 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: q_proj
2025-06-20 17:49:56.122 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: k_proj
2025-06-20 17:49:56.122 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: v_proj
2025-06-20 17:49:56.122 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: o_proj
2025-06-20 17:49:56.123 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: gate_proj
2025-06-20 17:49:56.123 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: up_proj
2025-06-20 17:49:56.124 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: down_proj
2025-06-20 17:49:56.124 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: q_proj
2025-06-20 17:49:56.124 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: k_proj
2025-06-20 17:49:56.125 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: v_proj
2025-06-20 17:49:56.125 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: o_proj
2025-06-20 17:49:56.125 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: gate_proj
2025-06-20 17:49:56.126 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: up_proj
2025-06-20 17:49:56.126 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: down_proj
2025-06-20 17:49:56.127 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: q_proj
2025-06-20 17:49:56.127 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: k_proj
2025-06-20 17:49:56.127 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: v_proj
2025-06-20 17:49:56.128 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: o_proj
2025-06-20 17:49:56.128 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: gate_proj
2025-06-20 17:49:56.129 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: up_proj
2025-06-20 17:49:56.129 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: down_proj
2025-06-20 17:49:56.130 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: q_proj
2025-06-20 17:49:56.130 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: k_proj
2025-06-20 17:49:56.130 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: v_proj
2025-06-20 17:49:56.131 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: o_proj
2025-06-20 17:49:56.131 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: gate_proj
2025-06-20 17:49:56.131 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: up_proj
2025-06-20 17:49:56.132 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: down_proj
2025-06-20 17:49:56.132 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: q_proj
2025-06-20 17:49:56.133 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: k_proj
2025-06-20 17:49:56.133 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: v_proj
2025-06-20 17:49:56.133 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: o_proj
2025-06-20 17:49:56.134 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: gate_proj
2025-06-20 17:49:56.134 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: up_proj
2025-06-20 17:49:56.135 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: down_proj
2025-06-20 17:49:56.135 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: q_proj
2025-06-20 17:49:56.135 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: k_proj
2025-06-20 17:49:56.136 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: v_proj
2025-06-20 17:49:56.136 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: o_proj
2025-06-20 17:49:56.136 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: gate_proj
2025-06-20 17:49:56.137 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: up_proj
2025-06-20 17:49:56.137 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: down_proj
2025-06-20 17:49:56.137 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: q_proj
2025-06-20 17:49:56.138 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: k_proj
2025-06-20 17:49:56.138 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: v_proj
2025-06-20 17:49:56.138 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: o_proj
2025-06-20 17:49:56.139 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: gate_proj
2025-06-20 17:49:56.139 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: up_proj
2025-06-20 17:49:56.140 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: down_proj
2025-06-20 17:49:56.140 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: q_proj
2025-06-20 17:49:56.140 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: k_proj
2025-06-20 17:49:56.141 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: v_proj
2025-06-20 17:49:56.141 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: o_proj
2025-06-20 17:49:56.141 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: gate_proj
2025-06-20 17:49:56.142 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: up_proj
2025-06-20 17:49:56.142 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: down_proj
2025-06-20 17:49:56.143 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: q_proj
2025-06-20 17:49:56.143 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: k_proj
2025-06-20 17:49:56.143 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: v_proj
2025-06-20 17:49:56.144 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: o_proj
2025-06-20 17:49:56.144 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: gate_proj
2025-06-20 17:49:56.144 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: up_proj
2025-06-20 17:49:56.145 | INFO     | utils.common:log:12 - enable Subspace Scaffold for weights in module: down_proj
2025-06-20 17:49:56.147 | INFO     | utils.common:log:12 - 
LlamaForCausalLM(
  (model): LlamaModel(
    (embed_tokens): Embedding(32000, 1024, padding_idx=31999)
    (layers): ModuleList(
      (0-23): 24 x LlamaDecoderLayer(
        (self_attn): LlamaAttention(
          (q_proj): SubScafLinear(in_feartures=64, out_features=1024)
          (k_proj): SubScafLinear(in_feartures=64, out_features=1024)
          (v_proj): SubScafLinear(in_feartures=64, out_features=1024)
          (o_proj): SubScafLinear(in_feartures=64, out_features=1024)
        )
        (mlp): LlamaMLP(
          (gate_proj): SubScafLinear(in_feartures=64, out_features=2736)
          (up_proj): SubScafLinear(in_feartures=64, out_features=2736)
          (down_proj): SubScafLinear(in_feartures=64, out_features=1024)
          (act_fn): SiLU()
        )
        (input_layernorm): LlamaRMSNorm((1024,), eps=1e-06)
        (post_attention_layernorm): LlamaRMSNorm((1024,), eps=1e-06)
      )
    )
    (norm): LlamaRMSNorm((1024,), eps=1e-06)
    (rotary_emb): LlamaRotaryEmbedding()
  )
  (lm_head): Linear(in_features=1024, out_features=32000, bias=False)
)

2025-06-20 17:49:56.147 | INFO     | utils.common:log:12 - Total params: 367.97M
2025-06-20 17:49:56.147 | INFO     | utils.common:log:12 - Trainable params before compression: 367.97M
2025-06-20 17:49:56.148 | INFO     | utils.common:log:12 - Trainable params after compression: 81.86M
2025-06-20 17:49:56.148 | INFO     | utils.common:log:12 - Total params with Subspace Scaffold enabled: 16.27M
/home/xuyuqi/.conda/envs/minimind/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:838: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.5 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
/home/xuyuqi/.conda/envs/minimind/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:838: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.5 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
/home/xuyuqi/.conda/envs/minimind/lib/python3.10/site-packages/torch/autograd/graph.py:824: UserWarning: c10d::broadcast_: an autograd kernel was not registered to the Autograd key(s) but we are trying to backprop through it. This may lead to silently incorrect behavior. This behavior is deprecated and will be removed in a future version of PyTorch. If your operator is differentiable, please ensure you have registered an autograd kernel to the correct Autograd key (e.g. DispatchKey::Autograd, DispatchKey::CompositeImplicitAutograd). If your operator is not differentiable, or to squash this warning and use the previous behavior, please register torch::CppFunction::makeFallthrough() to DispatchKey::Autograd. (Triggered internally at /pytorch/torch/csrc/autograd/autograd_not_implemented_fallback.cpp:62.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
/home/xuyuqi/.conda/envs/minimind/lib/python3.10/site-packages/torch/autograd/graph.py:824: UserWarning: c10d::broadcast_: an autograd kernel was not registered to the Autograd key(s) but we are trying to backprop through it. This may lead to silently incorrect behavior. This behavior is deprecated and will be removed in a future version of PyTorch. If your operator is differentiable, please ensure you have registered an autograd kernel to the correct Autograd key (e.g. DispatchKey::Autograd, DispatchKey::CompositeImplicitAutograd). If your operator is not differentiable, or to squash this warning and use the previous behavior, please register torch::CppFunction::makeFallthrough() to DispatchKey::Autograd. (Triggered internally at /pytorch/torch/csrc/autograd/autograd_not_implemented_fallback.cpp:62.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
2025-06-20 17:49:58.098 | INFO     | utils.common:log:12 - step: 1/10 Loss: 10.6137\10.614 Lr: 1.000e-3 Mem: 27.068 GB Throughput_tokens: 16.4226
2025-06-20 17:49:59.277 | INFO     | utils.common:log:12 - step: 2/10 Loss: 10.6187\10.614 Lr: 1.000e-3 Mem: 27.074 GB Throughput_tokens: 27.1594
2025-06-20 17:50:00.258 | INFO     | utils.common:log:12 - step: 3/10 Loss: 10.5965\10.612 Lr: 1.000e-3 Mem: 27.074 GB Throughput_tokens: 32.6330
2025-06-20 17:50:01.241 | INFO     | utils.common:log:12 - step: 4/10 Loss: 10.6088\10.612 Lr: 1.000e-3 Mem: 27.074 GB Throughput_tokens: 32.5773
2025-06-20 17:50:02.277 | INFO     | utils.common:log:12 - step: 5/10 Loss: 10.6192\10.613 Lr: 1.000e-3 Mem: 27.074 GB Throughput_tokens: 32.5473
2025-06-20 17:50:03.262 | INFO     | utils.common:log:12 - step: 6/10 Loss: 10.6179\10.613 Lr: 1.000e-3 Mem: 27.076 GB Throughput_tokens: 32.5110
2025-06-20 17:50:04.245 | INFO     | utils.common:log:12 - step: 7/10 Loss: 10.6213\10.614 Lr: 1.000e-3 Mem: 27.076 GB Throughput_tokens: 32.5787
2025-06-20 17:50:05.230 | INFO     | utils.common:log:12 - step: 8/10 Loss: 10.5871\10.611 Lr: 1.000e-3 Mem: 27.076 GB Throughput_tokens: 32.5308
2025-06-20 17:50:06.215 | INFO     | utils.common:log:12 - step: 9/10 Loss: 10.6061\10.611 Lr: 1.000e-3 Mem: 27.076 GB Throughput_tokens: 32.4893
2025-06-20 17:50:07.259 | INFO     | utils.common:log:12 - step: 10/10 Loss: 10.6001\10.610 Lr: 1.000e-3 Mem: 27.076 GB Throughput_tokens: 32.5424
2025-06-20 17:50:07.259 | INFO     | utils.common:log:12 - ETA: 00:00:00 
Rank 1 stopping training
2025-06-20 17:50:08.244 | INFO     | utils.common:log:12 - step: 11/10 Loss: 10.5679\10.606 Lr: 1.000e-3 Mem: 27.080 GB Throughput_tokens: 32.4885
2025-06-20 17:50:08.249 | INFO     | utils.common:log:12 - attain assigned training step 10. Stop Training
Rank 0 stopping training
2025-06-20 17:50:08.263 | INFO     | utils.common:log:12 - finish training
2025-06-20 17:50:08.299 | INFO     | utils.common:log:12 - Total Time: 00:00:21
